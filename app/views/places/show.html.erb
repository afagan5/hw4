<h1><%= @place["name"] %></h1>

<h2>My Posts</h2>

<div class="row">
<p>
  <a class="btn btn-primary" href="/posts/new?place_id=<%= @place["id"] %>" role="button">New Post</a>
</p>

<% if @current_user %>

<div class="row">
  <% for post in @posts %>
    <div class="col-md-3 col-sm-6">
      <h4>
      <%= post["title"] %>
       </h4>
       
      <%= post["posted_on"] %>
      <%= post["description"] %>
      
      </h4>
      <% if post.uploaded_image.attached? %>
      <img src="<%= url_for(post.uploaded_image)%>" class="img-fluid">
      <% else %>
      <img src="<%= post["image"] %>" class="img-fluid">
      <% end %>
      
    </div>
  <% end %>
</div>

<p>
<a class="btn btn-primary" href="/places" role="button">Back to All Places</a>
</p>
</div>

<% else %>
<% flash["notice"] = "Sorry, you need to be logged in to view and create posts." %>

<% end %>

---------

<div class="row">
  <% for post in @posts %>
    <div class="col-md-3 col-sm-6">
      <h4>
        <%# find user who created post %>
        <% user = User.find_by({ "id" => post["user_id"] }) %>
        <%# handle any potential bad data where the post is missing a user %>
        <% if user %>
          <%= user["first_name"] %>
        <% else %>
          anonymous
        <% end %>
      </h4>

      <% if post.uploaded_image.attached? %>
        <img src="<%= url_for(post.uploaded_image) %>" class="img-fluid">
      <% else %>
        <img src="<%= post["image"] %>" class="img-fluid">
      <% end %>

      <p><%= post["body"] %></p>
    </div>
  <% end %>
</div>
